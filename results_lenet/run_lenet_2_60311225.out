Get network
Branch locs:  [2]
Training
Get data
Training main network
training main:  True
0 :  0.8316947
1 :  0.95797473
2 :  0.9690148
3 :  0.9763915
4 :  0.9795473
5 :  0.9828136
6 :  0.9840991
7 :  0.9863557
8 :  0.9880385
9 :  0.9882592
10 :  0.9892523
11 :  0.9905985
12 :  0.9903282
13 :  0.9909185
14 :  0.99206614
15 :  0.99158615
16 :  0.9933406
17 :  0.9931144
18 :  0.9936606
19 :  0.9944496
20 :  0.9939751
21 :  0.9950124
22 :  0.9952276
23 :  0.99583995
24 :  0.99451584
25 :  0.9957958
26 :  0.9967889
27 :  0.99686617
28 :  0.9973848
29 :  0.9968165
30 :  0.99581236
31 :  0.99733514
32 :  0.99798065
33 :  0.99667305
34 :  0.9984772
35 :  0.9977489
36 :  0.9983117
37 :  0.9967007
38 :  0.99844414
39 :  0.99846065
40 :  0.99904
41 :  0.99846065
42 :  0.9986262
43 :  0.99847174
44 :  0.99450475
45 :  0.99740136
46 :  0.9988579
47 :  0.9996855
48 :  0.9997352
49 :  1.0
Main loss:  [0.6080717, 0.14007297, 0.10087282, 0.07800854, 0.06572072, 0.05719064, 0.051635854, 0.045117613, 0.040203825, 0.036922492, 0.03447735, 0.030877255, 0.030039204, 0.02864067, 0.025050616, 0.024858838, 0.021417871, 0.020505615, 0.019521998, 0.017718945, 0.01742179, 0.014694131, 0.01466531, 0.012914593, 0.016125474, 0.013243089, 0.010312007, 0.00967071, 0.008674375, 0.009302497, 0.011838172, 0.008533313, 0.0070025646, 0.009712979, 0.005275429, 0.007051463, 0.005208467, 0.0095453, 0.005293684, 0.004525875, 0.0030794917, 0.004802558, 0.003976095, 0.0044722324, 0.01721913, 0.0072829598, 0.0035893915, 0.0016007368, 0.0010439435, 0.00047856933]
Main acc:  [0.8316947, 0.95797473, 0.9690148, 0.9763915, 0.9795473, 0.9828136, 0.9840991, 0.9863557, 0.9880385, 0.9882592, 0.9892523, 0.9905985, 0.9903282, 0.9909185, 0.99206614, 0.99158615, 0.9933406, 0.9931144, 0.9936606, 0.9944496, 0.9939751, 0.9950124, 0.9952276, 0.99583995, 0.99451584, 0.9957958, 0.9967889, 0.99686617, 0.9973848, 0.9968165, 0.99581236, 0.99733514, 0.99798065, 0.99667305, 0.9984772, 0.9977489, 0.9983117, 0.9967007, 0.99844414, 0.99846065, 0.99904, 0.99846065, 0.9986262, 0.99847174, 0.99450475, 0.99740136, 0.9988579, 0.9996855, 0.9997352, 1.0]
Main time:  3845.3956377506256
Training branchynet network
training main:  False
0 :  [0.74160266 0.98563296]
1 :  [0.95908916 0.9916137 ]
2 :  [0.9696714  0.99440545]
3 :  [0.9750839 0.9963917]
4 :  [0.97878045 0.99757236]
5 :  [0.9805295 0.9968   ]
6 :  [0.98215157 0.9974455 ]
7 :  [0.9837129  0.99758345]
8 :  [0.9852964 0.9979586]
9 :  [0.9857764  0.99685514]
10 :  [0.98620677 0.9986758 ]
11 :  [0.98786193 0.9995366 ]
12 :  [0.9880771 0.9998179]
13 :  [0.987884  0.9998179]
14 :  [0.9895723 0.9994207]
15 :  [0.98895437 0.9986593 ]
16 :  [0.9901351 0.997931 ]
17 :  [0.989953  0.9967227]
18 :  [0.99099576 0.9973683 ]
19 :  [0.99150336 0.99854344]
20 :  [0.9919116 0.9983117]
21 :  [0.9913157  0.99882483]
22 :  [0.99203306 0.9989407 ]
23 :  [0.9926675  0.99880826]
24 :  [0.9927779  0.99834484]
25 :  [0.9928661  0.99791443]
26 :  [0.9926509 0.9986262]
27 :  [0.9936937  0.99910617]
28 :  [0.99379855 0.9988579 ]
29 :  [0.9937765 0.9992386]
30 :  [0.9941737 0.9989738]
31 :  [0.99392545 0.9992386 ]
32 :  [0.99451584 0.9982786 ]
33 :  [0.99554753 0.9985103 ]
34 :  [0.9948303 0.9981793]
35 :  [0.9951006 0.9987035]
36 :  [0.9957296 0.9986758]
37 :  [0.9953269 0.99824  ]
38 :  [0.9954924 0.9977655]
39 :  [0.99619305 0.9991559 ]
40 :  [0.99702066 0.9994372 ]
41 :  [0.9959282 0.9995531]
42 :  [0.99647444 0.9988855 ]
43 :  [0.9964248 0.9989407]
44 :  [0.99692136 0.99930483]
45 :  [0.9965075  0.99832827]
46 :  [0.9968882  0.99892414]
47 :  [0.9969655  0.99895173]
48 :  [0.9962096 0.9974179]
49 :  [0.99667305 0.9982124 ]
50 :  [0.9973848  0.99899036]
51 :  [0.9974455 0.9998179]
52 :  [0.99759996 0.9998179 ]
53 :  [0.9981131 0.9999669]
54 :  [0.99788135 1.        ]
55 :  [0.99796414 1.        ]
56 :  [0.9975614 1.       ]
57 :  [0.9970703 1.       ]
58 :  [0.9979034 1.       ]
59 :  [0.99726343 1.        ]
60 :  [0.998411 1.      ]
61 :  [0.99834484 1.        ]
62 :  [0.9986262 1.       ]
63 :  [0.9989738 1.       ]
64 :  [0.99832827 1.        ]
65 :  [0.9988579 1.       ]
66 :  [0.9984772 1.       ]
67 :  [0.9974179 1.       ]
68 :  [0.99892414 1.        ]
69 :  [0.9994372 1.       ]
70 :  [0.99928826 1.        ]
71 :  [0.9986924 1.       ]
72 :  [0.9992055 1.       ]
73 :  [0.9988745 1.       ]
74 :  [0.9970869 1.       ]
75 :  [0.99816275 1.        ]
76 :  [0.99822897 1.        ]
77 :  [0.99870896 1.        ]
78 :  [0.9994538 1.       ]
79 :  [0.9996855 1.       ]
80 :  [0.9995145 1.       ]
81 :  [0.9992717 1.       ]
82 :  [0.9981296 1.       ]
83 :  [0.9995862 1.       ]
84 :  [0.9977324  0.99591166]
85 :  [0.99771583 0.99427307]
86 :  [0.9989407 0.9976165]
87 :  [0.9993214 0.9984772]
88 :  [0.99884135 0.9989848 ]
89 :  [0.9994207 0.9990014]
90 :  [0.9994538 0.9987752]
91 :  [0.99950343 0.99960274]
92 :  [0.9998014 0.9998345]
93 :  [0.9999338 1.       ]
94 :  [0.9995862  0.99998343]
95 :  [0.9999669 1.       ]
96 :  [0.9999669 1.       ]
97 :  [0.99998343 1.        ]
98 :  [1. 1.]
99 :  [1. 1.]
Branch loss:  [array([0.8934412, 0.0476312], dtype=float32), array([0.1380009 , 0.02680514], dtype=float32), array([0.09873114, 0.01791832], dtype=float32), array([0.08042985, 0.0103968 ], dtype=float32), array([0.07039284, 0.0073448 ], dtype=float32), array([0.06250709, 0.0084433 ], dtype=float32), array([0.05634335, 0.00699975], dtype=float32), array([0.05113838, 0.00707068], dtype=float32), array([0.04704981, 0.00600952], dtype=float32), array([0.04518498, 0.00919378], dtype=float32), array([0.04234324, 0.00377648], dtype=float32), array([0.03917378, 0.00196988], dtype=float32), array([0.03831416, 0.00121174], dtype=float32), array([0.03722432, 0.00097384], dtype=float32), array([0.03275405, 0.00193246], dtype=float32), array([0.03473266, 0.0033687 ], dtype=float32), array([0.03112778, 0.00623513], dtype=float32), array([0.03144568, 0.00937025], dtype=float32), array([0.02886579, 0.00776151], dtype=float32), array([0.02702173, 0.00379812], dtype=float32), array([0.02625114, 0.0049098 ], dtype=float32), array([0.02630672, 0.00358471], dtype=float32), array([0.02576981, 0.00288716], dtype=float32), array([0.02314223, 0.00339335], dtype=float32), array([0.02251471, 0.00470075], dtype=float32), array([0.02335076, 0.00612638], dtype=float32), array([0.02212393, 0.00375365], dtype=float32), array([0.02019792, 0.00229711], dtype=float32), array([0.01946337, 0.00291647], dtype=float32), array([0.01900298, 0.00207737], dtype=float32), array([0.01798517, 0.00311366], dtype=float32), array([0.01774262, 0.00205925], dtype=float32), array([0.0171833 , 0.00463454], dtype=float32), array([0.01510618, 0.00444734], dtype=float32), array([0.01623863, 0.005421  ], dtype=float32), array([0.01535306, 0.00370844], dtype=float32), array([0.01384224, 0.003857  ], dtype=float32), array([0.01442825, 0.00508963], dtype=float32), array([0.01436966, 0.00777351], dtype=float32), array([0.01234489, 0.00262316], dtype=float32), array([0.01119864, 0.00153766], dtype=float32), array([0.01249529, 0.00145432], dtype=float32), array([0.01199933, 0.0029843 ], dtype=float32), array([0.01155321, 0.00379247], dtype=float32), array([0.01041721, 0.00210671], dtype=float32), array([0.01117042, 0.00512329], dtype=float32), array([0.01026469, 0.00292574], dtype=float32), array([0.00975374, 0.00331207], dtype=float32), array([0.01142252, 0.00919117], dtype=float32), array([0.01037475, 0.00630432], dtype=float32), array([0.00925312, 0.00258162], dtype=float32), array([0.00847167, 0.00059652], dtype=float32), array([0.00824901, 0.00051448], dtype=float32), array([0.00674031, 0.00025222], dtype=float32), array([7.3799565e-03, 9.5543517e-05], dtype=float32), array([7.272596e-03, 2.629837e-05], dtype=float32), array([8.2724113e-03, 2.3397986e-05], dtype=float32), array([9.0974849e-03, 2.3677178e-05], dtype=float32), array([7.1936310e-03, 1.9259314e-05], dtype=float32), array([8.2034133e-03, 2.3332463e-05], dtype=float32), array([5.9724939e-03, 1.8166873e-05], dtype=float32), array([5.552732e-03, 1.685444e-05], dtype=float32), array([4.9351156e-03, 1.4508154e-05], dtype=float32), array([4.2002941e-03, 1.2614949e-05], dtype=float32), array([5.0970190e-03, 1.1354385e-05], dtype=float32), array([4.49998816e-03, 1.25022425e-05], dtype=float32), array([5.1653567e-03, 1.0797001e-05], dtype=float32), array([7.7278353e-03, 1.3276003e-05], dtype=float32), array([3.8465138e-03, 1.0889292e-05], dtype=float32), array([2.975177e-03, 7.262953e-06], dtype=float32), array([3.0212821e-03, 7.2258690e-06], dtype=float32), array([4.46334155e-03, 1.21010535e-05], dtype=float32), array([3.4367857e-03, 8.4101221e-06], dtype=float32), array([4.1214768e-03, 6.4526503e-06], dtype=float32), array([8.3451057e-03, 1.3457269e-05], dtype=float32), array([5.418980e-03, 9.051645e-06], dtype=float32), array([5.2464786e-03, 9.2066603e-06], dtype=float32), array([4.2327056e-03, 8.9613168e-06], dtype=float32), array([2.3521844e-03, 6.9532489e-06], dtype=float32), array([1.8217477e-03, 4.7761750e-06], dtype=float32), array([1.910535e-03, 4.042145e-06], dtype=float32), array([2.7612310e-03, 4.9847386e-06], dtype=float32), array([5.5469554e-03, 6.7306896e-06], dtype=float32), array([1.9899916e-03, 4.7266776e-06], dtype=float32), array([0.00615028, 0.02581766], dtype=float32), array([0.00705455, 0.02624932], dtype=float32), array([0.00376784, 0.00864863], dtype=float32), array([0.00286338, 0.00588219], dtype=float32), array([0.00396475, 0.0024357 ], dtype=float32), array([0.00269686, 0.0029193 ], dtype=float32), array([0.00234066, 0.00449251], dtype=float32), array([0.00209489, 0.00109828], dtype=float32), array([0.00149875, 0.00059039], dtype=float32), array([9.1490976e-04, 6.1189996e-05], dtype=float32), array([1.7259492e-03, 8.2824532e-05], dtype=float32), array([8.0767530e-04, 5.4912583e-05], dtype=float32), array([6.2868570e-04, 1.9643598e-05], dtype=float32), array([6.4449257e-04, 1.5497477e-05], dtype=float32), array([5.8000151e-04, 1.2945388e-05], dtype=float32), array([5.4262549e-04, 1.1762714e-05], dtype=float32)]
Branch acc:  [array([0.74160266, 0.98563296], dtype=float32), array([0.95908916, 0.9916137 ], dtype=float32), array([0.9696714 , 0.99440545], dtype=float32), array([0.9750839, 0.9963917], dtype=float32), array([0.97878045, 0.99757236], dtype=float32), array([0.9805295, 0.9968   ], dtype=float32), array([0.98215157, 0.9974455 ], dtype=float32), array([0.9837129 , 0.99758345], dtype=float32), array([0.9852964, 0.9979586], dtype=float32), array([0.9857764 , 0.99685514], dtype=float32), array([0.98620677, 0.9986758 ], dtype=float32), array([0.98786193, 0.9995366 ], dtype=float32), array([0.9880771, 0.9998179], dtype=float32), array([0.987884 , 0.9998179], dtype=float32), array([0.9895723, 0.9994207], dtype=float32), array([0.98895437, 0.9986593 ], dtype=float32), array([0.9901351, 0.997931 ], dtype=float32), array([0.989953 , 0.9967227], dtype=float32), array([0.99099576, 0.9973683 ], dtype=float32), array([0.99150336, 0.99854344], dtype=float32), array([0.9919116, 0.9983117], dtype=float32), array([0.9913157 , 0.99882483], dtype=float32), array([0.99203306, 0.9989407 ], dtype=float32), array([0.9926675 , 0.99880826], dtype=float32), array([0.9927779 , 0.99834484], dtype=float32), array([0.9928661 , 0.99791443], dtype=float32), array([0.9926509, 0.9986262], dtype=float32), array([0.9936937 , 0.99910617], dtype=float32), array([0.99379855, 0.9988579 ], dtype=float32), array([0.9937765, 0.9992386], dtype=float32), array([0.9941737, 0.9989738], dtype=float32), array([0.99392545, 0.9992386 ], dtype=float32), array([0.99451584, 0.9982786 ], dtype=float32), array([0.99554753, 0.9985103 ], dtype=float32), array([0.9948303, 0.9981793], dtype=float32), array([0.9951006, 0.9987035], dtype=float32), array([0.9957296, 0.9986758], dtype=float32), array([0.9953269, 0.99824  ], dtype=float32), array([0.9954924, 0.9977655], dtype=float32), array([0.99619305, 0.9991559 ], dtype=float32), array([0.99702066, 0.9994372 ], dtype=float32), array([0.9959282, 0.9995531], dtype=float32), array([0.99647444, 0.9988855 ], dtype=float32), array([0.9964248, 0.9989407], dtype=float32), array([0.99692136, 0.99930483], dtype=float32), array([0.9965075 , 0.99832827], dtype=float32), array([0.9968882 , 0.99892414], dtype=float32), array([0.9969655 , 0.99895173], dtype=float32), array([0.9962096, 0.9974179], dtype=float32), array([0.99667305, 0.9982124 ], dtype=float32), array([0.9973848 , 0.99899036], dtype=float32), array([0.9974455, 0.9998179], dtype=float32), array([0.99759996, 0.9998179 ], dtype=float32), array([0.9981131, 0.9999669], dtype=float32), array([0.99788135, 1.        ], dtype=float32), array([0.99796414, 1.        ], dtype=float32), array([0.9975614, 1.       ], dtype=float32), array([0.9970703, 1.       ], dtype=float32), array([0.9979034, 1.       ], dtype=float32), array([0.99726343, 1.        ], dtype=float32), array([0.998411, 1.      ], dtype=float32), array([0.99834484, 1.        ], dtype=float32), array([0.9986262, 1.       ], dtype=float32), array([0.9989738, 1.       ], dtype=float32), array([0.99832827, 1.        ], dtype=float32), array([0.9988579, 1.       ], dtype=float32), array([0.9984772, 1.       ], dtype=float32), array([0.9974179, 1.       ], dtype=float32), array([0.99892414, 1.        ], dtype=float32), array([0.9994372, 1.       ], dtype=float32), array([0.99928826, 1.        ], dtype=float32), array([0.9986924, 1.       ], dtype=float32), array([0.9992055, 1.       ], dtype=float32), array([0.9988745, 1.       ], dtype=float32), array([0.9970869, 1.       ], dtype=float32), array([0.99816275, 1.        ], dtype=float32), array([0.99822897, 1.        ], dtype=float32), array([0.99870896, 1.        ], dtype=float32), array([0.9994538, 1.       ], dtype=float32), array([0.9996855, 1.       ], dtype=float32), array([0.9995145, 1.       ], dtype=float32), array([0.9992717, 1.       ], dtype=float32), array([0.9981296, 1.       ], dtype=float32), array([0.9995862, 1.       ], dtype=float32), array([0.9977324 , 0.99591166], dtype=float32), array([0.99771583, 0.99427307], dtype=float32), array([0.9989407, 0.9976165], dtype=float32), array([0.9993214, 0.9984772], dtype=float32), array([0.99884135, 0.9989848 ], dtype=float32), array([0.9994207, 0.9990014], dtype=float32), array([0.9994538, 0.9987752], dtype=float32), array([0.99950343, 0.99960274], dtype=float32), array([0.9998014, 0.9998345], dtype=float32), array([0.9999338, 1.       ], dtype=float32), array([0.9995862 , 0.99998343], dtype=float32), array([0.9999669, 1.       ], dtype=float32), array([0.9999669, 1.       ], dtype=float32), array([0.99998343, 1.        ], dtype=float32), array([1., 1.], dtype=float32), array([1., 1.], dtype=float32)]
Branch time:  13595.512666225433
BranchyNet.testing()
test suite
utils test
g_baseacc:  0.9903
g_basediff:  1.7639796495437623
screen branchy
